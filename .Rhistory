parse_kenpom_row <- function(row) {
date <- as.Date(stringr::str_sub(row, 1, 10), format = "%m/%d/%Y")
away_team <- stringr::str_trim(stringr::str_sub(row, 12, 33))
away_score <- as.integer(stringr::str_trim(stringr::str_sub(row, 34, 37)))
home_team <- stringr::str_trim(stringr::str_sub(row, 39, 60))
home_score <- as.integer(stringr::str_trim(stringr::str_sub(row, 61, 64)))
neutral <- stringr::str_trim(stringr::str_sub(row, 65, 66)) == "N"
return(data.frame(Date = date, Away_team = away_team, Away_score = away_score,
Home_team = home_team, Home_score = home_score, neutral = neutral))
}
x <- fetch_and_format_kenpom_data(2022)
?substr
fetch_and_format_kenpom_data <- function(year) {
kenpom_url <- paste0("https://kenpom.com/cbbga",
substr(year, 3, 4), ".txt")
kenpom_response <- httr::GET(kenpom_url)
kenpom_content <- httr::content(kenpom_response, "text")
kenpom_rows <- stringr::str_split(kenpom_content, "\n")[[1]]
kenpom_data <- do.call(rbind, lapply(kenpom_rows[-length(kenpom_rows)],
parse_kenpom_row))
kenpom_data <- kenpom_data %>%
dplyr::mutate(Away_team = str_replace_all(Away_team, "St\\.", "State"))
kenpom_data <- kenpom_data %>%
dplyr::mutate(Home_team = str_replace_all(Home_team, "St\\.", "State"))
return(kenpom_data)
}
x <- fetch_and_format_kenpom_data(2022)
View(x)
use_r("fetch_and_format_warrennolan_data")
fetch_and_format_kenpom_data <- function(year) {
kenpom_url <- paste0("https://kenpom.com/cbbga",
substr(year, 3, 4), ".txt")
kenpom_response <- httr::GET(kenpom_url)
kenpom_content <- httr::content(kenpom_response, "text")
kenpom_rows <- stringr::str_split(kenpom_content, "\n")[[1]]
kenpom_data <- do.call(rbind, lapply(kenpom_rows[-length(kenpom_rows)],
parse_kenpom_row))
kenpom_data <- kenpom_data |>
dplyr::mutate(Away_team = str_replace_all(Away_team, "St\\.", "State"))
kenpom_data <- kenpom_data |>
dplyr::mutate(Home_team = str_replace_all(Home_team, "St\\.", "State"))
return(kenpom_data)
}
x <- fetch_and_format_kenpom_data(2022)
View(x)
sum(isTRUE(x$neutral))
sum(x$neutral)
length(x$neutral)
?read_html
fetch_and_format_warrennolan_data <- function(year) {
warrennolan_url <- paste0("https://www.warrennolan.com/basketball/",
year, "/net")
warrennolan_data <- xml2::read_html(warrennolan_url) |>
rvest::html_table(header = TRUE, fill = TRUE) |>
.[[1]]
return(warrennolan_data)
}
fetch_and_format_warrennolan_data <- function(year) {
warrennolan_url <- paste0("https://www.warrennolan.com/basketball/",
year, "/net")
warrennolan_data <- xml2::read_html(warrennolan_url) %>%
rvest::html_table(header = TRUE, fill = TRUE) %>%
.[[1]]
return(warrennolan_data)
}
fetch_and_format_warrennolan_data(2023)
devtools::load_all()
?lapply
devtools::load_all()
devtools::load_all()
devtools::document()
devtools::document()
use_r("match_names")
?trimws
stringdist()
?stringdist
use_r("combine_datasets")
?left_join
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
x <- fetch_and_format_kenpom_data(2023)
x
devtools::document()
devtools::document()
devtools::document()
document()
detach(magrittr)
detach("magrittr")
x <- fetch_and_format_warrennolan_data(2023)
devtools::document()
document()
devtools::document()
devtools::document()
devtools::document()
x <- get_combined_data(2023)
View(x)
library(devtools)
load_all()
x <- get_combined_data(2023)
x
View(x)
x <- fetch_and_format_warrennolan_data(2023)
use_r("home_sor")
View(x)
x <- get_combined_data(2023)
View(x)
TRUE*7
y <- fetch_and_format_warrennolan_data(2023)
nrow(y)
363/2
styler:::style_active_file()
styler:::style_active_file()
0 - TRUE*10
devtools::document()
devtools::document()
home_sor(85,75,150,363)
devtools::document()
home_sor(85,75,150,363)
home_sor(85,75,1,363)
home_sor(85,75,363,363)
home_sor(85,95,363,363)
home_sor(85,95,153,363)
home_sor(85,95,180,363)
home_sor(85,95,179,363)
home_sor(85,95,177,363)
home_sor(85,95,170,363)
home_sor(85,95,171,363)
home_sor(85,95,172,363)
170*2
use_r("away_sor")
devtools::document()
sor_points(89,78,1,363,TRUE)
sor_points(89,78,1,363,FALSE)
devtools::document()
sor_points(89,78,1,363,FALSE)
sor_points(89,78,363,363,FALSE)
sor_points(89,78,363,363,TRUE)
devtools::document()
sor_points(89,78,363,363,TRUE)
sor_points(89,78,1,363,FALSE)
devtools::check()
x$home_sor <- sor_points(x$Home_score, x$Away_score, length(y), TRUE, x$neutral)
devtools::document()
x$home_sor <- sor_points(x$Home_score, x$Away_score, length(y), TRUE, x$neutral)
x$home_sor <- sor_points(x$Home_score, x$Away_score, rep(nrow(y),nrow(x)), rep(TRUE,nrow(x)), x$neutral)
z <- sor_points(x$Home_score, x$Away_score, length(y), TRUE, x$neutral)
z <- c()
for (i in length(z)){
z[i] <- sor_points(x$Home_score[i], x$Away_score[i], norw(y), TRUE, x$neutral[i])
}
View(x)
total_score <- x$Away_score + x$Home_score
View(complete.cases(x))
View(x[complete.cases(x),])
x <- complete.cases(x)
x <- complete.cases(x)
devtools::document()
get_combined_data(2021)
devtools::document()
x <- get_combined_data(2021)
nrow(x)
View(x)
devtools::document()
get_combined_data(2022)
x <- get_combined_data(2022)
View(x)
y <- fetch_and_format_warrennolan_data(2022)
z <- sor_points(x$Home_score, x$Away_score, x$away_NET, nrow(y), TRUE)
x <- dplyr::mutate(x, home_sor = sor_points(x$Home_score, x$Away_score, x$away_NET, nrow(y), TRUE))
colnames(x)
x <- dplyr::mutate(x, home_sor = sor_points(Home_score, Away_score, away_NET, nrow(y), TRUE, nuetral))
x <- dplyr::mutate(x, home_sor = sor_points(Home_score, Away_score, away_NET, nrow(y), TRUE, neutral))
x$home_sor <- sor_points(x$Home_score, x$Away_score, x$away_NET, nrow(y), TRUE, x$neutral)
x <- x %>%
rowwise() %>%
mutate(home_sor = sor_points(Home_score, Away_score, away_NET, nrow(x), TRUE, neutral))
View(x)
sor_points(93,64,101,358,TRUE,0)
x <- x %>%
rowwise() %>%
mutate(home_sor = sor_points(Home_score, Away_score, away_NET, nrow(y), TRUE, neutral))
x <- x |>
rowwise() |>
mutate(home_sor = sor_points(Home_score, Away_score, away_NET, nrow(y), TRUE, neutral))
styler:::style_active_file()
devtools::document()
x <- get_combined_data(2023)
devtools::document()
x <- get_combined_data(2023)
View(x)
sor_points(65, 56, 305, 363, TRUE)
use_test("sor_points")
?sor_points
test_that("Beating best team on the road is worth 1", {
expect_equal(sor_points(85, 50, 1, 360, FALSE), 1)
})
library(testthat)
library(devtools)
test_that("Beating best team on the road is worth 1", {
expect_equal(sor_points(85, 50, 1, 360, FALSE), 1)
})
test_that("Losing to best team on the road is worth 0", {
expect_equal(sor_points(85, 90, 1, 360, FALSE), 0)
})
test_that("Beating worst team at home is worth 0", {
expect_equal(sor_points(85, 40, 360, 360, FALSE), 0)
})
test_that("Beating worst team at home is worth 0", {
expect_equal(sor_points(85, 40, 360, 360, TRUE), 0)
})
test_that("Losing to worst team at home is worth -1", {
expect_equal(sor_points(85, 40, 360, 360, TRUE), -1)
})
test_that("Losing to worst team at home is worth -1", {
expect_equal(sor_points(85, 90, 360, 360, TRUE), -1)
})
(sor_points(85, 90, 150, 300, TRUE, TRUE)
)
sor_points(85, 90, 150.5, 300, TRUE, TRUE)
median(1:363)
test_that("Beating average team on neutral court worth 0.5", {
expect_equal(sor_points(85, 90, 182, 363, TRUE, TRUE), 0.5)
})
test_that("Beating average team on neutral court worth 0.5", {
expect_equal(sor_points(85, 80, 182, 363, TRUE, TRUE), 0.5)
})
test_that("Losing to average team on neutral court worth -0.5", {
expect_equal(sor_points(85, 90, 182, 363, TRUE, TRUE), -0.5)
})
test_that("Neutral Home and neutral away worth the same", {
expect_equal(
sor_points(85, 90, 50, 363, TRUE, TRUE),
sor_points(85, 90, 50, 363, FALSE, TRUE)
)
})
devtools::document()
devtools::load_all()
get_combined_data(2023)
x <- get_combined_data(2023)
View(x)
devtools::document()
x <- get_combined_data(2023, "2023-03-12")
devtools::document()
x <- get_combined_data(2023, "2023-03-12")
devtools::document()
x <- get_combined_data(2023, "2023-03-12")
devtools::document()
x <- get_combined_data(2023, "2023-03-12")
View(x)
x[nrow(x),]
devtools::check()
head(x)
unique(x$Home_team)
sort(unique(x))
sort(unique(x$Home_team))
devtools::document()
x <- get_combined_data(2023, "2023-03-12")
View(x)
length(unique(x$Home_team))
y <- fetch_and_format_warrennolan_data(2023)
y$Team
all_teams <- y$Team
included_teams <- unique(x$Home_team)
all_teams[!all_teams %in% included_teams]
devtools::document()
x <- get_combined_data(2023, "2023-03-12")
included_teams <- unique(x$Home_team)
y <- fetch_and_format_warrennolan_data(2023)
all_teams <- y$Team
sort(all_teams)
devtools::document()
x <- get_combined_data(2023, "2023-03-12")
y <- fetch_and_format_warrennolan_data(2023)
included_teams <- unique(x$Home_team)
length(included_teams)
all_teams <- y$Team
all_teams[!all_teams %in% included_teams]
styler:::style_active_file()
x <- get_combined_data(2023, "2023-03-12")
y <- fetch_and_format_warrennolan_data(2023)
included_teams <- unique(x$Home_team)
all_teams <- y$Team
all_teams[!all_teams %in% included_teams]
devtools::document()
x <- get_combined_data(2023, "2023-03-12")
y <- fetch_and_format_warrennolan_data(2023)
included_teams <- unique(x$Home_team)
all_teams <- y$Team
all_teams[!all_teams %in% included_teams]
length(all_teams[!all_teams %in% included_teams])
devtools::document()
x <- get_combined_data(2023, "2023-03-12")
y <- fetch_and_format_warrennolan_data(2023)
included_teams <- unique(x$Home_team)
all_teams <- y$Team
all_teams[!all_teams %in% included_teams]
styler:::style_active_file()
devtools::document()
x <- get_combined_data(2023, "2023-03-12")
y <- fetch_and_format_warrennolan_data(2023)
included_teams <- unique(x$Home_team)
all_teams <- y$Team
all_teams[!all_teams %in% included_teams]
devtools::document()
x <- get_combined_data(2023, "2023-03-12")
y <- fetch_and_format_warrennolan_data(2023)
included_teams <- unique(x$Home_team)
all_teams <- y$Team
all_teams[!all_teams %in% included_teams]
devtools::document()
x <- get_combined_data(2023, "2023-03-12")
y <- fetch_and_format_warrennolan_data(2023)
included_teams <- unique(x$Home_team)
all_teams <- y$Team
all_teams[!all_teams %in% included_teams]
devtools::document()
x <- get_combined_data(2023, "2023-03-12")
y <- fetch_and_format_warrennolan_data(2023)
included_teams <- unique(x$Home_team)
all_teams <- y$Team
all_teams[!all_teams %in% included_teams]
styler:::style_selection()
devtools::document()
x <- get_combined_data(2023, "2023-03-12")
y <- fetch_and_format_warrennolan_data(2023)
included_teams <- unique(x$Home_team)
all_teams <- y$Team
all_teams[!all_teams %in% included_teams]
devtools::document()
x <- get_combined_data(2023, "2023-03-12")
y <- fetch_and_format_warrennolan_data(2023)
included_teams <- unique(x$Home_team)
all_teams <- y$Team
all_teams[!all_teams %in% included_teams]
length(inclued_teams)
length(included_teams)
x <- get_combined_data(2022, "2023-03-12")
y <- fetch_and_format_warrennolan_data(2022)
included_teams <- unique(x$Home_team)
all_teams <- y$Team
all_teams[!all_teams %in% included_teams]
x <- get_combined_data(2021, "2023-03-12")
y <- fetch_and_format_warrennolan_data(2021)
included_teams <- unique(x$Home_team)
all_teams <- y$Team
all_teams[!all_teams %in% included_teams]
rankings <- sum_sor(2023, "2023-03-12")
devtools::document()
rankings <- sum_sor(2023, "2023-03-12")
View(rankings)
devtools::check()
library(stat5555sor)
View(rankings)
rankings <- sum_sor(2023, "2023-03-12")
View(rankings)
get_combined_data(2023, "2023-03-12")
?sum_sor
?get_combined_data
year_2023 <- sum_sor(2023,"2023-03-12")
year_2022 <- sum_sor(2022,"2022-03-13")
year_2021 <- sum_sor(2021,"2021-03-14")
year_2023$ranking <- c(1:nrow(year_2023))
devtools::document()
year_2023 <- sum_sor(2023,"2023-03-12")
year_2022 <- sum_sor(2022,"2022-03-13")
year_2021 <- sum_sor(2021,"2021-03-14")
View(year_2023)
year_2023$year <- rep(2023, nrow(year_2023))
year_2022$year <- rep(2022, nrow(year_2022))
year_2021$year <- rep(2021, nrow(year_2021))
View(year_2023)
## binding data
?rbind
## binding data
combined_years <- rbind(year_2023, year_2022, year_2021)
combined_years[1,]
combined_years[nrow(combined_years),]
combined_years[nrow(combined_years)/2,]
usethis::use_data_raw()
## Getting data for each year
year_2023 <- sum_sor(2023,"2023-03-12")
year_2022 <- sum_sor(2022,"2022-03-13")
year_2021 <- sum_sor(2021,"2021-03-14")
## Adding year to data before combining
year_2023$year <- rep(2023, nrow(year_2023))
year_2022$year <- rep(2022, nrow(year_2022))
year_2021$year <- rep(2021, nrow(year_2021))
## binding data
combined_years <- rbind(year_2023, year_2022, year_2021)
usethis::use_data(combined_years, overwrite = TRUE)
View(combined_years)
devtools::document()
?combined_years
usethis::use_data_raw("games_2023")
usethis::use_data_raw()
usethis::use_data_raw()
usethis::use_data_raw("games_2023")
devtools::check()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
library(devtools)
use_data_raw("year_2023")
?get_combined_data
## code to prepare `year_2023` dataset goes here
games_2023 <- get_combined_data(2023, "2023-03-12")
usethis::use_data(games_2023, overwrite = TRUE)
combined_years
games_2023
devtools::document()
devtools::check()
use_data_raw("rankings_2023")
rankings_2023 <- sum_sor(2023, "2023-03-12")
usethis::use_data(rankings_2023, overwrite = TRUE)
rankings_2023
devtools::
devtools::document()
devtools::check()
#Data for Problem 39
test <- c(676, 206, 230, 256, 280, 433, 337, 466, 497, 512, 794, 428, 452, 512)
ctrl <- c(88, 570, 605, 617, 653, 2913, 924, 286, 1098, 982, 2346, 321, 615, 519)
diffs <- test - control
diffs <- test - ctrl
mean(diffs)
sd(diffs)
?qt
qt(0.025,length(test) - 1)
t <- qt(0.025,length(test) - 1)
mean(diffs) + t*sd(diffs)/sqrt(n)
mean(diffs) + t*sd(diffs)/sqrt(length(diffs))
mean(diffs) - t*sd(diffs)/sqrt(length(diffs))
qqplot(diffs)
library(ggplot2)
library(qqplotr)
install.packages("qqplotr")
library(qqplotr)
# plot the data without line and labels
ggplot(mapping = aes(sample = diffs)) + stat_qq_point(size = 3)+ stat_qq_line(color="green")
t.test(diffs)
wilcox.test(test, ctrl)
t.test(test, ctrl, paired = TRUE)
wilcox.test(test,ctrl, paired = TRUE)
#Data for Problem 44
schizo.total <- c(16.6, 33.3, 34.1, 0.0, 119.8, 0.1, 25.3, 359.3, 6.6, 0.4, 62.8, 0.2, 13.0, 0.0, 0.0, 5.9, 0.1, 6.0, 32.1, 0.0)
non.total <- c(289.4, 0.0, 620.4, 0.0, 8.5, 5.5, 43.2, 91.7, 200.9, 113.8, 102.2, 108.2, 36.9, 122.0, 101.9)
schizo.mg <- c(0.19, 0.44, 0.39, 0.0, 1.75, 0.01, 0.27, 5.99, 0.1, 0.01, 0.68, 0.01, 0.15, 0.0, 0.0, 0.1, 0.01, 0.07, 0.42, 0.0)
non.mg <- c(3.96, 0.0, 7.95, 0.0, 0.1, 0.09, 0.91, 1.0, 3.46, 2.01, 1.5, 1.98, 0.49, 1.72, 1.52)
t.test(schizo.total, non.total)
t.test(schizo.mg, non.mg)
wilcox.test(schizo.mg, non.mg)
wilcox.test(schizo.total,non.total)
devtools::document()
devtools::check()
library(devtools)
devtools::document()
devtools::check()
devtools::document()
devtools::check()
devtools::document()
devtools::check()
devtools::clean()
devtools::build_vignettes()
devtools::document()
devtools::check()
devtools::document()
devtools::check()
devtools::document()
lintr:::addin_lint_package()
warrennolan_url <- paste0(
"https://www.warrennolan.com/basketball/",
year, "/net"
)
warrennolan_url <- paste0(
"https://www.warrennolan.com/basketball/",
2023, "/net"
)
warrennolan_data <- xml2::read_html(warrennolan_url) %>%
rvest::html_table(header = TRUE, fill = TRUE) %>%
.[[1]]
library(tidyverse)
library(devtools)
document()
document()
x <- get_combined_data(2023)
x <- get_combined_data(2023, "2023-03-12")
devtools::document()
x <- get_combined_data(2023, "2023-03-12")
document()
x <- get_combined_data(2023, "2023-03-12")
View(x)
lintr:::addin_lint_package()
document()
lintr:::addin_lint()
document()
x <- get_combined_data(2023, "2023-03-12")
document()
x <- get_combined_data(2023, "2023-03-12")
document()
x <- get_combined_data(2023, "2023-03-12")
document()
x <- get_combined_data(2023, "2023-03-12")
View(x)
lintr:::addin_lint()
lintr:::addin_lint()
length(unique(x$Home_team))
check()
library(devtools)
lintr:::addin_lint_package()
